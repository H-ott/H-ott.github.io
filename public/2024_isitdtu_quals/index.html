<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>ISITDTU Quals 2024 - Duc Dat Dau</title><meta name="Description" content="Solution for ISITDTU Quals 2024"><meta property="og:title" content="ISITDTU Quals 2024" />
<meta property="og:description" content="Solution for ISITDTU Quals 2024" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ducdatdau.github.io/2024_isitdtu_quals/" /><meta property="og:image" content="https://ducdatdau.github.io/logo.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-11-01T16:42:03+07:00" />
<meta property="article:modified_time" content="2024-11-01T16:42:03+07:00" /><meta property="og:site_name" content="FazeCT blog" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://ducdatdau.github.io/logo.png"/>

<meta name="twitter:title" content="ISITDTU Quals 2024"/>
<meta name="twitter:description" content="Solution for ISITDTU Quals 2024"/>
<meta name="application-name" content="Blogs">
<meta name="apple-mobile-web-app-title" content="Blogs"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://ducdatdau.github.io/2024_isitdtu_quals/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "ISITDTU Quals 2024",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/ducdatdau.github.io\/2024_isitdtu_quals\/"
        },"genre": "posts","keywords": "RE, ISITDTU, vietnamese","wordcount":  3898 ,
        "url": "https:\/\/ducdatdau.github.io\/2024_isitdtu_quals\/","datePublished": "2024-11-01T16:42:03+07:00","dateModified": "2024-11-01T16:42:03+07:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "ducdatdau"
            },"description": "Solution for ISITDTU Quals 2024"
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('dark' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'dark' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Duc Dat Dau">Blogs</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/aboutme/"> About Me </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Duc Dat Dau">Blogs</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/aboutme/" title="">About Me</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">ISITDTU Quals 2024</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://ducdatdau.github.io/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>ducdatdau</a></span>&nbsp;<span class="post-category">included in <a href="/categories/writeups/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>Writeups</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2024-11-01">2024-11-01</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;3898 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;19 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#revanimal">rev/animal</a></li>
    <li><a href="#revre01">rev/re01</a></li>
    <li><a href="#revre02">rev/re02</a></li>
    <li><a href="#revthe-chamber-of-flag">rev/The Chamber of Flag</a></li>
    <li><a href="#pwnshellcode-2">pwn/shellcode 2</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>Solution for ISITDTU Quals 2024</p>
<h1 id="isitdtu-quals-2024">ISITDTU Quals 2024</h1>
<h2 id="revanimal">rev/animal</h2>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ul>
<li>31 solves / 100 pts / by kinjazz</li>
<li><strong>Given files:</strong> chall</li>
<li><strong>Description:</strong> Find the hidden animal</li>
</ul>
</div>
        </div>
    </div>
<p><strong>Solution</strong></p>
<p>Đề bài cho chúng ta một file PE64. Mở bằng IDA64, tổng quan chương trình sẽ như sau</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://hackmd.io/_uploads/HkZDC-fWJx.png"
        data-srcset="https://hackmd.io/_uploads/HkZDC-fWJx.png, https://hackmd.io/_uploads/HkZDC-fWJx.png 1.5x, https://hackmd.io/_uploads/HkZDC-fWJx.png 2x"
        data-sizes="auto"
        alt="https://hackmd.io/_uploads/HkZDC-fWJx.png"
        title="https://hackmd.io/_uploads/HkZDC-fWJx.png" /></p>
<p>Chương trình yêu cầu nhập flag có độ dài 36 ký tự, trong đó có điều kiện check ở một số idex cụ thể.</p>
<p>Khi click vào hàm <strong><code>check_flag</code></strong>, ta nhận được thông báo lỗi như sau</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://hackmd.io/_uploads/H1lDA-Mbkl.png"
        data-srcset="https://hackmd.io/_uploads/H1lDA-Mbkl.png, https://hackmd.io/_uploads/H1lDA-Mbkl.png 1.5x, https://hackmd.io/_uploads/H1lDA-Mbkl.png 2x"
        data-sizes="auto"
        alt="https://hackmd.io/_uploads/H1lDA-Mbkl.png"
        title="https://hackmd.io/_uploads/H1lDA-Mbkl.png" /></p>
<p>Qua tab IDA View chế độ non-graph, ta thấy đây chỉ là một lệnh gọi hàm bình thường</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://hackmd.io/_uploads/BJ-DCZG-yx.png"
        data-srcset="https://hackmd.io/_uploads/BJ-DCZG-yx.png, https://hackmd.io/_uploads/BJ-DCZG-yx.png 1.5x, https://hackmd.io/_uploads/BJ-DCZG-yx.png 2x"
        data-sizes="auto"
        alt="https://hackmd.io/_uploads/BJ-DCZG-yx.png"
        title="https://hackmd.io/_uploads/BJ-DCZG-yx.png" /></p>
<p>Vậy mình sẽ debug từng dòng và sửa các kết quả check để chương trình tới được đến đoạn này. Đây là chương trình khi mình nhảy vào <strong><code>rax</code></strong></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://hackmd.io/_uploads/HkxWD0bGWJx.png"
        data-srcset="https://hackmd.io/_uploads/HkxWD0bGWJx.png, https://hackmd.io/_uploads/HkxWD0bGWJx.png 1.5x, https://hackmd.io/_uploads/HkxWD0bGWJx.png 2x"
        data-sizes="auto"
        alt="https://hackmd.io/_uploads/HkxWD0bGWJx.png"
        title="https://hackmd.io/_uploads/HkxWD0bGWJx.png" /></p>
<p>Ấn phím <strong><code>p</code></strong> để create function và thu được đống mã giả của hàm này như sau</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="n">_BOOL8</span> <span class="kr">__fastcall</span> <span class="nf">sub_21871F785</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">a1</span><span class="p">)</span>
<span class="p">{</span>
    <span class="p">[...]</span>

  <span class="n">v2</span> <span class="o">=</span> <span class="n">a1</span><span class="p">[</span><span class="mi">27</span><span class="p">];</span>
  <span class="n">v3</span> <span class="o">=</span> <span class="n">a1</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
  <span class="n">v4</span> <span class="o">=</span> <span class="n">a1</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
  <span class="n">v5</span> <span class="o">=</span> <span class="n">a1</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
  <span class="n">v6</span> <span class="o">=</span> <span class="n">a1</span><span class="p">[</span><span class="mi">29</span><span class="p">];</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">v5</span> <span class="o">*</span> <span class="n">v3</span> <span class="o">+</span> <span class="n">v4</span> <span class="o">*</span> <span class="n">v2</span> <span class="o">*</span> <span class="n">a1</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span> <span class="o">-</span> <span class="n">v6</span> <span class="o">!=</span> <span class="mi">538738</span> <span class="p">)</span>
    <span class="k">return</span> <span class="mi">0</span><span class="n">i64</span><span class="p">;</span>
  <span class="n">v7</span> <span class="o">=</span> <span class="n">a1</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
  <span class="n">v8</span> <span class="o">=</span> <span class="n">a1</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>
  <span class="n">v9</span> <span class="o">=</span> <span class="n">a1</span><span class="p">[</span><span class="mi">20</span><span class="p">];</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">a1</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">+</span> <span class="n">v9</span> <span class="o">*</span> <span class="n">v8</span> <span class="o">*</span> <span class="n">v7</span> <span class="o">-</span> <span class="n">a1</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">-</span> <span class="n">a1</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">665370</span> <span class="p">)</span>
    <span class="k">return</span> <span class="mi">0</span><span class="n">i64</span><span class="p">;</span>
  <span class="n">v10</span> <span class="o">=</span> <span class="n">a1</span><span class="p">[</span><span class="mi">30</span><span class="p">];</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">a1</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">a1</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">a1</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span> <span class="o">-</span> <span class="n">v10</span> <span class="o">*</span> <span class="n">a1</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">2945</span> <span class="p">)</span>
    <span class="k">return</span> <span class="mi">0</span><span class="n">i64</span><span class="p">;</span>
  <span class="n">v11</span> <span class="o">=</span> <span class="n">a1</span><span class="p">[</span><span class="mi">18</span><span class="p">];</span>
  <span class="n">v12</span> <span class="o">=</span> <span class="n">a1</span><span class="p">[</span><span class="mi">33</span><span class="p">];</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">v12</span> <span class="o">+</span> <span class="n">a1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">a1</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">-</span> <span class="n">v11</span> <span class="o">-</span> <span class="n">a1</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">-</span> <span class="n">v7</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">191</span> <span class="p">)</span>
    <span class="k">return</span> <span class="mi">0</span><span class="n">i64</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">v3</span> <span class="o">+</span> <span class="n">v10</span> <span class="o">+</span> <span class="n">v11</span> <span class="o">+</span> <span class="n">a1</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span> <span class="o">*</span> <span class="n">v6</span> <span class="o">-</span> <span class="n">v5</span> <span class="o">!=</span> <span class="mi">4853</span> <span class="p">)</span>
    <span class="k">return</span> <span class="mi">0</span><span class="n">i64</span><span class="p">;</span>
  <span class="n">v13</span> <span class="o">=</span> <span class="n">a1</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span>
  <span class="n">v14</span> <span class="o">=</span> <span class="n">a1</span><span class="p">[</span><span class="mi">13</span><span class="p">];</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">v14</span> <span class="o">+</span> <span class="n">a1</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">-</span> <span class="n">v13</span> <span class="o">*</span> <span class="n">a1</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">*</span> <span class="n">a1</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span> <span class="o">*</span> <span class="n">a1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">86153321</span> <span class="p">)</span>
    <span class="k">return</span> <span class="mi">0</span><span class="n">i64</span><span class="p">;</span>
  <span class="n">v15</span> <span class="o">=</span> <span class="n">a1</span><span class="p">[</span><span class="mi">9</span><span class="p">];</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">v14</span> <span class="o">+</span> <span class="n">v15</span> <span class="o">*</span> <span class="n">a1</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">*</span> <span class="n">a1</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">+</span> <span class="n">v2</span> <span class="o">*</span> <span class="n">v8</span> <span class="o">!=</span> <span class="mi">873682</span> <span class="p">)</span>
    <span class="k">return</span> <span class="mi">0</span><span class="n">i64</span><span class="p">;</span>
  <span class="n">v16</span> <span class="o">=</span> <span class="n">v15</span> <span class="o">*</span> <span class="n">a1</span><span class="p">[</span><span class="mi">21</span><span class="p">];</span>
  <span class="n">v17</span> <span class="o">=</span> <span class="n">a1</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
  <span class="n">v18</span> <span class="o">=</span> <span class="n">v11</span> <span class="o">*</span> <span class="n">v16</span><span class="p">;</span>
  <span class="n">v19</span> <span class="o">=</span> <span class="n">a1</span><span class="p">[</span><span class="mi">22</span><span class="p">];</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">v19</span> <span class="o">+</span> <span class="n">a1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">v18</span> <span class="o">-</span> <span class="n">v17</span> <span class="o">!=</span> <span class="mi">451644</span> <span class="p">)</span>
    <span class="k">return</span> <span class="mi">0</span><span class="n">i64</span><span class="p">;</span>
  <span class="n">v20</span> <span class="o">=</span> <span class="n">a1</span><span class="p">[</span><span class="mi">24</span><span class="p">];</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">a1</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span> <span class="o">+</span> <span class="n">a1</span><span class="p">[</span><span class="mi">34</span><span class="p">]</span> <span class="o">+</span> <span class="n">v20</span> <span class="o">+</span> <span class="n">v4</span> <span class="o">*</span> <span class="n">a1</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span> <span class="o">-</span> <span class="n">v7</span> <span class="o">!=</span> <span class="mi">9350</span> <span class="p">)</span>
    <span class="k">return</span> <span class="mi">0</span><span class="n">i64</span><span class="p">;</span>
  <span class="n">v21</span> <span class="o">=</span> <span class="n">a1</span><span class="p">[</span><span class="mi">17</span><span class="p">];</span>
  <span class="n">v22</span> <span class="o">=</span> <span class="n">a1</span><span class="p">[</span><span class="mi">19</span><span class="p">];</span>
  <span class="n">v29</span> <span class="o">=</span> <span class="n">a1</span><span class="p">[</span><span class="mi">35</span><span class="p">];</span>
  <span class="n">v28</span> <span class="o">=</span> <span class="n">a1</span><span class="p">[</span><span class="mi">26</span><span class="p">];</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">v20</span> <span class="o">+</span> <span class="n">v29</span> <span class="o">+</span> <span class="n">a1</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span> <span class="o">-</span> <span class="n">v22</span> <span class="o">-</span> <span class="n">v28</span> <span class="o">-</span> <span class="n">v17</span> <span class="o">!=</span> <span class="mi">27</span> <span class="p">)</span>
    <span class="k">return</span> <span class="mi">0</span><span class="n">i64</span><span class="p">;</span>
  <span class="n">v23</span> <span class="o">=</span> <span class="n">a1</span><span class="p">[</span><span class="mi">15</span><span class="p">];</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">a1</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">+</span> <span class="n">a1</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">+</span> <span class="n">v23</span> <span class="o">+</span> <span class="n">a1</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span> <span class="o">*</span> <span class="n">v22</span> <span class="o">-</span> <span class="n">a1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="mi">11247</span>
    <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">v24</span> <span class="o">=</span> <span class="n">v13</span> <span class="o">*</span> <span class="n">a1</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span> <span class="n">v25</span> <span class="o">=</span> <span class="n">a1</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">v25</span> <span class="o">+</span> <span class="n">v21</span> <span class="o">+</span> <span class="n">v24</span> <span class="o">-</span> <span class="n">v23</span> <span class="o">-</span> <span class="n">a1</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span> <span class="o">==</span> <span class="mi">13297</span><span class="p">)</span>
    <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">v26</span> <span class="o">=</span> <span class="o">*</span><span class="n">a1</span><span class="p">,</span> <span class="n">v5</span> <span class="o">+</span> <span class="n">v29</span> <span class="o">+</span> <span class="n">v28</span> <span class="o">+</span> <span class="n">a1</span><span class="p">[</span><span class="mi">28</span><span class="p">]</span> <span class="o">-</span> <span class="n">v26</span> <span class="o">-</span> <span class="n">v9</span> <span class="o">==</span> <span class="mi">266</span><span class="p">)</span>
    <span class="o">&amp;&amp;</span> <span class="n">v25</span> <span class="o">+</span> <span class="n">v21</span> <span class="o">+</span> <span class="n">v26</span> <span class="o">+</span> <span class="n">a1</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">*</span> <span class="n">a1</span><span class="p">[</span><span class="mi">28</span><span class="p">]</span> <span class="o">-</span> <span class="n">v3</span> <span class="o">==</span> <span class="mi">10422</span>
    <span class="o">&amp;&amp;</span> <span class="n">v19</span> <span class="o">+</span> <span class="n">v23</span> <span class="o">+</span> <span class="n">a1</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">*</span> <span class="n">v22</span> <span class="o">-</span> <span class="n">a1</span><span class="p">[</span><span class="mi">34</span><span class="p">]</span> <span class="o">-</span> <span class="n">a1</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">==</span> <span class="mi">9883</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="k">return</span> <span class="n">v8</span> <span class="o">*</span> <span class="n">v12</span> <span class="o">+</span> <span class="n">a1</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">v9</span><span class="p">)</span> <span class="o">-</span> <span class="n">v26</span> <span class="o">==</span> <span class="o">-</span><span class="mi">5604</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="k">return</span> <span class="mi">0</span><span class="n">i64</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Tới đây chúng ta sẽ biết được luôn phải dùng Z3 để tìm ra flag. Lời giải của mình như sau</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">z3</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">solver</span> <span class="o">=</span> <span class="n">Solver</span><span class="p">()</span>

<span class="n">flag</span> <span class="o">=</span> <span class="p">[</span><span class="n">Int</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;flag[</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">]&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">36</span><span class="p">)]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">36</span><span class="p">):</span>
    <span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">128</span><span class="p">)</span>

<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">))</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">))</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">))</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">))</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">))</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">))</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">))</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;{&#39;</span><span class="p">))</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x61</span><span class="p">)</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x63</span><span class="p">)</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x61</span><span class="p">)</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x74</span><span class="p">)</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">33</span><span class="p">]</span> <span class="o">==</span> <span class="n">flag</span><span class="p">[</span><span class="mi">34</span><span class="p">])</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">35</span><span class="p">]</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;}&#39;</span><span class="p">))</span>

<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="o">*</span> <span class="n">flag</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">*</span> <span class="n">flag</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span> <span class="o">-</span> <span class="n">flag</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="mi">451644</span><span class="p">)</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">24</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">35</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span> <span class="o">-</span> <span class="n">flag</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="o">-</span> <span class="n">flag</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span> <span class="o">-</span> <span class="n">flag</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="mi">27</span><span class="p">)</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">*</span> <span class="n">flag</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="o">*</span> <span class="n">flag</span><span class="p">[</span><span class="mi">27</span><span class="p">]</span> <span class="o">*</span> <span class="n">flag</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span> <span class="o">-</span> <span class="n">flag</span><span class="p">[</span><span class="mi">29</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x83872</span><span class="p">)</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="o">*</span> <span class="n">flag</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">*</span> <span class="n">flag</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">-</span> <span class="n">flag</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">-</span> <span class="n">flag</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">==</span> <span class="mi">665370</span><span class="p">)</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">flag</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span> <span class="o">-</span> <span class="n">flag</span><span class="p">[</span><span class="mi">30</span><span class="p">]</span> <span class="o">*</span> <span class="n">flag</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2945</span><span class="p">)</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">33</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">flag</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">-</span> <span class="n">flag</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="o">-</span> <span class="n">flag</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">-</span> <span class="n">flag</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">191</span><span class="p">)</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">30</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span> <span class="o">*</span> <span class="n">flag</span><span class="p">[</span><span class="mi">29</span><span class="p">]</span> <span class="o">-</span> <span class="n">flag</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4853</span><span class="p">)</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">-</span> <span class="n">flag</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">*</span> <span class="n">flag</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">*</span> <span class="n">flag</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span> <span class="o">*</span> <span class="n">flag</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">86153321</span><span class="p">)</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">*</span> <span class="n">flag</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">*</span> <span class="n">flag</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">27</span><span class="p">]</span> <span class="o">*</span> <span class="n">flag</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">==</span> <span class="mi">873682</span><span class="p">)</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">34</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">24</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="o">*</span> <span class="n">flag</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span> <span class="o">-</span> <span class="n">flag</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="mi">9350</span><span class="p">)</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span> <span class="o">*</span> <span class="n">flag</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="o">-</span> <span class="n">flag</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="mi">11247</span><span class="p">)</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">*</span> <span class="n">flag</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">-</span> <span class="n">flag</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">-</span> <span class="n">flag</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span> <span class="o">==</span> <span class="mi">13297</span><span class="p">)</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">35</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">28</span><span class="p">]</span> <span class="o">-</span> <span class="n">flag</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">flag</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="o">==</span> <span class="mi">266</span><span class="p">)</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">*</span> <span class="n">flag</span><span class="p">[</span><span class="mi">28</span><span class="p">]</span> <span class="o">-</span> <span class="n">flag</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">10422</span><span class="p">)</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">*</span> <span class="n">flag</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="o">-</span> <span class="n">flag</span><span class="p">[</span><span class="mi">34</span><span class="p">]</span> <span class="o">-</span> <span class="n">flag</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">==</span> <span class="mi">9883</span><span class="p">)</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">*</span> <span class="n">flag</span><span class="p">[</span><span class="mi">33</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">flag</span><span class="p">[</span><span class="mi">20</span><span class="p">])</span> <span class="o">-</span> <span class="n">flag</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">5604</span><span class="p">)</span>

<span class="k">if</span> <span class="n">solver</span><span class="o">.</span><span class="n">check</span><span class="p">()</span> <span class="o">==</span> <span class="n">sat</span><span class="p">:</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">model</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;0xDEADBEEF&#34;</span><span class="p">)</span>

<span class="n">flag</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">73</span>
<span class="n">flag</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">83</span>
<span class="n">flag</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">73</span>
<span class="n">flag</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">84</span>
<span class="n">flag</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">68</span>
<span class="n">flag</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">84</span>
<span class="n">flag</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mi">85</span>
<span class="n">flag</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mi">123</span>
<span class="n">flag</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="mi">97</span>
<span class="n">flag</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span> <span class="o">=</span> <span class="mi">99</span>
<span class="n">flag</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="o">=</span> <span class="mi">97</span>
<span class="n">flag</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="o">=</span> <span class="mi">116</span>
<span class="n">flag</span><span class="p">[</span><span class="mi">35</span><span class="p">]</span> <span class="o">=</span> <span class="mi">125</span>
<span class="n">flag</span><span class="p">[</span><span class="mi">33</span><span class="p">]</span> <span class="o">=</span> <span class="mi">33</span>
<span class="n">flag</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">flag</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="mi">108</span>
<span class="n">flag</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span> <span class="o">=</span> <span class="mi">117</span>
<span class="n">flag</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span> <span class="o">=</span> <span class="mi">110</span>
<span class="n">flag</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span> <span class="o">=</span> <span class="mi">49</span>
<span class="n">flag</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="mi">95</span>
<span class="n">flag</span><span class="p">[</span><span class="mi">27</span><span class="p">]</span> <span class="o">=</span> <span class="mi">114</span>
<span class="n">flag</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span> <span class="o">=</span> <span class="mi">95</span>
<span class="n">flag</span><span class="p">[</span><span class="mi">29</span><span class="p">]</span> <span class="o">=</span> <span class="mi">97</span>
<span class="n">flag</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="mi">103</span>
<span class="n">flag</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="mi">48</span>
<span class="n">flag</span><span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="o">=</span> <span class="mi">97</span>
<span class="n">flag</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">=</span> <span class="mi">110</span>
<span class="n">flag</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span> <span class="o">=</span> <span class="mi">101</span>
<span class="n">flag</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="mi">95</span>
<span class="n">flag</span><span class="p">[</span><span class="mi">30</span><span class="p">]</span> <span class="o">=</span> <span class="mi">114</span>
<span class="n">flag</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="mi">95</span>
<span class="n">flag</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">=</span> <span class="mi">101</span>
<span class="n">flag</span><span class="p">[</span><span class="mi">28</span><span class="p">]</span> <span class="o">=</span> <span class="mi">95</span>
<span class="n">flag</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span> <span class="o">=</span> <span class="mi">48</span>
<span class="n">flag</span><span class="p">[</span><span class="mi">34</span><span class="p">]</span> <span class="o">=</span> <span class="mi">33</span>
<span class="n">flag</span><span class="p">[</span><span class="mi">24</span><span class="p">]</span> <span class="o">=</span> <span class="mi">121</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">chr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">flag</span><span class="p">]))</span>
</code></pre></td></tr></table>
</div>
</div><p>Flag thu được là <code>ISITDTU{a_g0lden_cat_1n_y0ur_area!!}</code></p>
<h2 id="revre01">rev/re01</h2>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ul>
<li>46 solves / 100 pts</li>
<li><strong>Given files:</strong> re01.zip</li>
<li><strong>Description:</strong> VC++ ;)</li>
</ul>
</div>
        </div>
    </div>
<p><strong>Solution</strong></p>
<p>Đề bài cho chúng ta một file PE64, mở bằng IDA64, quan sát tổng thể ta có thể thấy chương trình dùng SHA1 để hash input và so sánh với chuỗi hash <strong><code>eeeddf4ae0c3364f189a37f79c9d7223a1d60ac7</code></strong></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://hackmd.io/_uploads/B1wW1zM-1e.png"
        data-srcset="https://hackmd.io/_uploads/B1wW1zM-1e.png, https://hackmd.io/_uploads/B1wW1zM-1e.png 1.5x, https://hackmd.io/_uploads/B1wW1zM-1e.png 2x"
        data-sizes="auto"
        alt="https://hackmd.io/_uploads/B1wW1zM-1e.png"
        title="https://hackmd.io/_uploads/B1wW1zM-1e.png" /></p>
<p>Sau một hồi thử crack chuỗi hash kia không được, mình tiếp tục đi xem có function nào đáng nghi không. Và đây chính là hàm mà mình chú ý tới <strong><code>TlsCallback_0</code></strong></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://hackmd.io/_uploads/SybDA-fb1e.png"
        data-srcset="https://hackmd.io/_uploads/SybDA-fb1e.png, https://hackmd.io/_uploads/SybDA-fb1e.png 1.5x, https://hackmd.io/_uploads/SybDA-fb1e.png 2x"
        data-sizes="auto"
        alt="https://hackmd.io/_uploads/SybDA-fb1e.png"
        title="https://hackmd.io/_uploads/SybDA-fb1e.png" /></p>
<p>Chương trình sử dụng anti-debug và gọi nó trong hàm TLS. Mình đặt breakpoint ở đoạn check <strong><code>IsDebuggerPresent</code></strong> và sửa giá trị cho <strong><code>ZF</code></strong> để chương trình tiếp tục được đi vào trong hàm <strong><code>sub_140004000</code></strong></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://hackmd.io/_uploads/rkMPCWf-ke.png"
        data-srcset="https://hackmd.io/_uploads/rkMPCWf-ke.png, https://hackmd.io/_uploads/rkMPCWf-ke.png 1.5x, https://hackmd.io/_uploads/rkMPCWf-ke.png 2x"
        data-sizes="auto"
        alt="https://hackmd.io/_uploads/rkMPCWf-ke.png"
        title="https://hackmd.io/_uploads/rkMPCWf-ke.png" /></p>
<p>Chúng ta dễ dàng nhận ra input length = 58. Mình sẽ tạo mới input và debug lại. Kiểm tra các giá trị ở đoạn so sánh, ta biết được điều kiện check flag sẽ là</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="mh">0x35</span> <span class="o">==</span> <span class="n">v7</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> 
</code></pre></td></tr></table>
</div>
</div><p>Dễ dàng lấy toàn bộ giá trị của <strong><code>v7</code></strong> và xor ngược lại, ta thu được flag <strong><code>ISITDTU{Congrats_You_Solved_TLS_Callback_Re01_Have_Fun_:)}</code></strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">X</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x7C</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x7C</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> 
    <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x61</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x71</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> 
    <span class="mh">0x61</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x60</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x4E</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> 
    <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x76</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x5A</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> 
    <span class="mh">0x5B</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x52</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x47</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> 
    <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> 
    <span class="mh">0x46</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x6A</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x6C</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> 
    <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x5A</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> 
    <span class="mh">0x6A</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x5A</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> 
    <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x59</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x43</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> 
    <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x51</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x6A</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> 
    <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x61</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x79</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> 
    <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x6A</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x76</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> 
    <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x59</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> 
    <span class="mh">0x59</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x57</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> 
    <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x56</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x5E</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> 
    <span class="mh">0x6A</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> 
    <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> 
    <span class="mh">0x6A</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x7D</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> 
    <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x43</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> 
    <span class="mh">0x6A</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x73</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> 
    <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x5B</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x6A</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> 
    <span class="mh">0x0F</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x1C</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> 
    <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">]</span>

<span class="n">flag</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">chr</span><span class="p">(</span><span class="mh">0x35</span> <span class="o">^</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">],</span> <span class="s2">&#34;little&#34;</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="mi">4</span><span class="p">)])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="revre02">rev/re02</h2>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ul>
<li>29 solves / 100 pts</li>
<li><strong>Given files:</strong> re02.zip</li>
<li><strong>Description:</strong> NES, good luck ;)</li>
</ul>
</div>
        </div>
    </div>
<p><strong>Solution</strong></p>
<p>Đề bài cho chúng ta một file <strong><code>re02.nes</code></strong>, đây là một Nintendo ROM image file. Sau một hồi tìm kiếm, mình tìm được tool <strong><code>FCEUX</code></strong> có thể ****emulate và debug file này.</p>
<p>Mở chương trình lên thì thấy một màn hình đen kịt</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://hackmd.io/_uploads/rkWP0ZzZ1x.png"
        data-srcset="https://hackmd.io/_uploads/rkWP0ZzZ1x.png, https://hackmd.io/_uploads/rkWP0ZzZ1x.png 1.5x, https://hackmd.io/_uploads/rkWP0ZzZ1x.png 2x"
        data-sizes="auto"
        alt="https://hackmd.io/_uploads/rkWP0ZzZ1x.png"
        title="https://hackmd.io/_uploads/rkWP0ZzZ1x.png" /></p>
<p>Vào tab Debug → Hex Editor thấy 3 byte đầu nhảy liên tục, chứng tỏ rằng chương trình vẫn đang hoạt động bình thường.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://hackmd.io/_uploads/B1-wRbzZJx.png"
        data-srcset="https://hackmd.io/_uploads/B1-wRbzZJx.png, https://hackmd.io/_uploads/B1-wRbzZJx.png 1.5x, https://hackmd.io/_uploads/B1-wRbzZJx.png 2x"
        data-sizes="auto"
        alt="https://hackmd.io/_uploads/B1-wRbzZJx.png"
        title="https://hackmd.io/_uploads/B1-wRbzZJx.png" /></p>
<p>Sau khi thử nhập một vài phím và check toàn bộ dữ liệu trong tab Hex Editor, mình phát hiện input được xuất hiện ở các địa chỉ:</p>
<ul>
<li>0x0300</li>
<li>0x0B00</li>
<li>0x1300</li>
<li>0x1B00</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://hackmd.io/_uploads/rkgDC-fZJx.png"
        data-srcset="https://hackmd.io/_uploads/rkgDC-fZJx.png, https://hackmd.io/_uploads/rkgDC-fZJx.png 1.5x, https://hackmd.io/_uploads/rkgDC-fZJx.png 2x"
        data-sizes="auto"
        alt="https://hackmd.io/_uploads/rkgDC-fZJx.png"
        title="https://hackmd.io/_uploads/rkgDC-fZJx.png" /></p>
<p>và có một số đặc điểm như sau:</p>
<ul>
<li>Độ dài tối đa input là 16</li>
<li>Có 7 phím được chấp nhận và nó sẽ được map như sau:
<ul>
<li><strong><code>s</code></strong> → <strong><code>a</code></strong></li>
<li><strong><code>d</code></strong> → <strong><code>u</code></strong></li>
<li><strong><code>f</code></strong> → <strong><code>t</code></strong></li>
<li><strong><code>up arrow</code></strong> → <strong><code>n</code></strong></li>
<li><strong><code>right arrow</code></strong> → <strong><code>i</code></strong></li>
<li><strong><code>down arrow</code></strong> → <strong><code>h</code></strong></li>
<li><strong><code>left arrow</code></strong> → <strong><code>l</code></strong></li>
</ul>
</li>
</ul>
<p>Sau khi đã biết chỗ nhập input thì chỗ check flag sẽ nằm ở đâu?</p>
<p>Mình vào tab Debug → Debugger, tìm đoạn code nào có chứa <strong><code>300</code></strong> (địa chỉ input) hoặc lệnh <strong><code>cmp</code></strong> thì ra được đoạn này</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://hackmd.io/_uploads/ry-DAWzWJg.png"
        data-srcset="https://hackmd.io/_uploads/ry-DAWzWJg.png, https://hackmd.io/_uploads/ry-DAWzWJg.png 1.5x, https://hackmd.io/_uploads/ry-DAWzWJg.png 2x"
        data-sizes="auto"
        alt="https://hackmd.io/_uploads/ry-DAWzWJg.png"
        title="https://hackmd.io/_uploads/ry-DAWzWJg.png" /></p>
<p>Nếu tinh ý, ta có thể nhận ra các block check input khá tương tự nhau. Lấy các giá trị ở địa chỉ 300, 301 và 302 cộng với nhau, sau đó so sánh với 0x4A. Ví dụ cho block check đầu tiên sẽ là</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="nb">input</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="nb">input</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="nb">input</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x4A</span>
</code></pre></td></tr></table>
</div>
</div><p>Thực hiện tương tự cho các block sau, chúng ta có thể tìm ra được <strong><code>mapped_input</code></strong> bằng Z3</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">z3</span> <span class="kn">import</span> <span class="o">*</span> 

<span class="n">solver</span> <span class="o">=</span> <span class="n">Solver</span><span class="p">()</span>
<span class="n">flag</span> <span class="o">=</span> <span class="p">[</span><span class="n">BitVec</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;flag[</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">]&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">)]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
    <span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Or</span><span class="p">((</span><span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)),</span> <span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;u&#39;</span><span class="p">)),</span> <span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)),</span> <span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)),</span> <span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;l&#39;</span><span class="p">)),</span> <span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">)),</span> <span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">))))</span>

<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x4A</span><span class="p">)</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x44</span><span class="p">)</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x3B</span><span class="p">)</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x43</span><span class="p">)</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x43</span><span class="p">)</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x3F</span><span class="p">)</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x42</span><span class="p">)</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x3D</span><span class="p">)</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x43</span><span class="p">)</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x3F</span><span class="p">)</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x4A</span><span class="p">)</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x51</span><span class="p">)</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x4A</span><span class="p">)</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x44</span><span class="p">)</span>

<span class="k">if</span> <span class="n">solver</span><span class="o">.</span><span class="n">check</span><span class="p">()</span> <span class="o">==</span> <span class="n">sat</span><span class="p">:</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">model</span><span class="p">()</span>
    <span class="n">res</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">model</span><span class="p">[</span><span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">as_long</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;......&#34;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>Kết quả thu được là <strong><code>tuanlinhlinhtuan</code>,</strong> bây giờ ta chỉ cần nhập input đúng với các key đã được map sẽ có được flag là <strong><code>ISITDTU{Throw_back_the_nested_if_NES_have_funnnn_:)}</code></strong></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://hackmd.io/_uploads/rybD0ZGW1g.png"
        data-srcset="https://hackmd.io/_uploads/rybD0ZGW1g.png, https://hackmd.io/_uploads/rybD0ZGW1g.png 1.5x, https://hackmd.io/_uploads/rybD0ZGW1g.png 2x"
        data-sizes="auto"
        alt="https://hackmd.io/_uploads/rybD0ZGW1g.png"
        title="https://hackmd.io/_uploads/rybD0ZGW1g.png" /></p>
<h2 id="revthe-chamber-of-flag">rev/The Chamber of Flag</h2>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ul>
<li>28 solves / 100 pts / by ks75vl</li>
<li><strong>Given files:</strong> <a href="https://ctf.isitdtu.com/files/77c8d53ffc4bef692852e6468b8174e7/TheChamberOfFlag_11BA527D91D85F332DEBC3145E3E1C4A.zip?token=eyJ1c2VyX2lkIjoyMzUwLCJ0ZWFtX2lkIjoxNDAyLCJmaWxlX2lkIjo1OX0.Zx57Aw.lAwlfdig9LbY7snwdAWv-QVZw2Q" target="_blank" rel="noopener noreffer ">TheChamberOfFlag_11BA527D91D85F332DEBC3145E3E1C4A.zip</a></li>
<li><strong>Description:</strong> Try to unlock the Chamber and get the Flag.</li>
</ul>
</div>
        </div>
    </div>
<p><strong>Solution</strong></p>
<p>Đề bài cho chúng ta một file PE64, chạy thử chương trình, ta thấy có 2 option để lựa chọn:</p>
<ul>
<li>login
<ul>
<li>Nhập secret key</li>
</ul>
</li>
<li>about</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://hackmd.io/_uploads/r1-DRbzWkg.png"
        data-srcset="https://hackmd.io/_uploads/r1-DRbzWkg.png, https://hackmd.io/_uploads/r1-DRbzWkg.png 1.5x, https://hackmd.io/_uploads/r1-DRbzWkg.png 2x"
        data-sizes="auto"
        alt="https://hackmd.io/_uploads/r1-DRbzWkg.png"
        title="https://hackmd.io/_uploads/r1-DRbzWkg.png" /></p>
<p>Mình thử nhập secret và nhận thấy:</p>
<ul>
<li>Độ dài secret = 6</li>
<li>Nhập sai sẽ cho nhập tiếp</li>
</ul>
<p>Mở file bằng IDA64, chương trình nhìn rất lớn và phức tạp. Mình nhảy qua tab string và nhận thấy chương trình có gọi các hàm encrypt của WinAPI.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="14.png"
        data-srcset="14.png, 14.png 1.5x, 14.png 2x"
        data-sizes="auto"
        alt="14.png"
        title="14.png" /></p>
<p>Trace theo các hàm này, mình tìm ra được hàm <strong><code>sub_7FF6A0F51530</code></strong> thực hiện việc mã hóa input và đi kiểm tra tính hợp lệ của nó.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://hackmd.io/_uploads/SJWvAZM-yg.png"
        data-srcset="https://hackmd.io/_uploads/SJWvAZM-yg.png, https://hackmd.io/_uploads/SJWvAZM-yg.png 1.5x, https://hackmd.io/_uploads/SJWvAZM-yg.png 2x"
        data-sizes="auto"
        alt="https://hackmd.io/_uploads/SJWvAZM-yg.png"
        title="https://hackmd.io/_uploads/SJWvAZM-yg.png" /></p>
<p>Sau khi debug và decrypt <strong><code>AlgId</code></strong>, chúng ta biết được chương trình sử dụng hash SHA256. Thông tin chi tiết các bạn có thể đọc thêm ở đây <a href="https://learn.microsoft.com/en-us/windows/win32/api/bcrypt/nf-bcrypt-bcryptopenalgorithmprovider" target="_blank" rel="noopener noreffer ">https://learn.microsoft.com/en-us/windows/win32/api/bcrypt/nf-bcrypt-bcryptopenalgorithmprovider</a></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://hackmd.io/_uploads/HkgWPRWfbkl.png"
        data-srcset="https://hackmd.io/_uploads/HkgWPRWfbkl.png, https://hackmd.io/_uploads/HkgWPRWfbkl.png 1.5x, https://hackmd.io/_uploads/HkgWPRWfbkl.png 2x"
        data-sizes="auto"
        alt="https://hackmd.io/_uploads/HkgWPRWfbkl.png"
        title="https://hackmd.io/_uploads/HkgWPRWfbkl.png" /></p>
<p>Tiếp tục debug và ta lấy được <strong><code>checked_hash</code></strong> = <strong><code>26F2D45844BFDBC8E5A2AE67149AA6C50E897A2A48FBF479D1BFB9F0D4E24544</code></strong></p>
<p>Với input có độ dài 6 ký tự, mình sẽ dùng <strong><code>hashcat</code></strong> để bruteforce nhằm tìm ra giá trị tương ứng với mã hash này. Kết quả thu được là <strong><code>808017</code></strong></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="image.png"
        data-srcset="image.png, image.png 1.5x, image.png 2x"
        data-sizes="auto"
        alt="image.png"
        title="image.png" /></p>
<p>Đăng nhập thành công, chúng ta chọn option flag nhưng lại xuất hiện thông báo flag crashed.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://hackmd.io/_uploads/HygbwAbf-yg.png"
        data-srcset="https://hackmd.io/_uploads/HygbwAbf-yg.png, https://hackmd.io/_uploads/HygbwAbf-yg.png 1.5x, https://hackmd.io/_uploads/HygbwAbf-yg.png 2x"
        data-sizes="auto"
        alt="https://hackmd.io/_uploads/HygbwAbf-yg.png"
        title="https://hackmd.io/_uploads/HygbwAbf-yg.png" /></p>
<p>Sau khi xref chuỗi trên, mình tìm ra được đoạn code có liên quan tới chuỗi trên ở đây.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://hackmd.io/_uploads/H1-P0-zW1x.png"
        data-srcset="https://hackmd.io/_uploads/H1-P0-zW1x.png, https://hackmd.io/_uploads/H1-P0-zW1x.png 1.5x, https://hackmd.io/_uploads/H1-P0-zW1x.png 2x"
        data-sizes="auto"
        alt="https://hackmd.io/_uploads/H1-P0-zW1x.png"
        title="https://hackmd.io/_uploads/H1-P0-zW1x.png" /></p>
<p>Đi phân tích hàm <strong><code>sub_7FF7AFB110C8</code></strong>, ta thấy nó decrypt dữ liệu bằng thuật toán AES mode CBC.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">sub_7FF7AFB110C8</span><span class="p">(</span><span class="n">PUCHAR</span> <span class="n">pbInput</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a2</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a3</span><span class="p">,</span> <span class="n">UCHAR</span> <span class="o">*</span><span class="n">a4</span><span class="p">,</span> <span class="n">PUCHAR</span> <span class="n">a5</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">char</span> <span class="n">v7</span><span class="p">;</span> <span class="c1">// al
</span><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="n">v8</span><span class="p">;</span> <span class="c1">// rcx
</span><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="n">v9</span><span class="p">;</span> <span class="c1">// rcx
</span><span class="c1"></span>  <span class="kt">char</span> <span class="n">v10</span><span class="p">;</span> <span class="c1">// al
</span><span class="c1"></span>  <span class="kt">char</span> <span class="n">v11</span><span class="p">;</span> <span class="c1">// bl
</span><span class="c1"></span>  <span class="kt">char</span> <span class="n">v12</span><span class="p">;</span> <span class="c1">// al
</span><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="n">v13</span><span class="p">;</span> <span class="c1">// rcx
</span><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="n">v14</span><span class="p">;</span> <span class="c1">// rcx
</span><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">v15</span><span class="p">;</span> <span class="c1">// ebx
</span><span class="c1"></span>  <span class="n">HANDLE</span> <span class="n">ProcessHeap</span><span class="p">;</span> <span class="c1">// rax
</span><span class="c1"></span>  <span class="n">UCHAR</span> <span class="o">*</span><span class="n">v17</span><span class="p">;</span> <span class="c1">// rbx
</span><span class="c1"></span>  <span class="n">HANDLE</span> <span class="n">v18</span><span class="p">;</span> <span class="c1">// rax
</span><span class="c1"></span>  <span class="n">WCHAR</span> <span class="n">pszProperty</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span> <span class="c1">// [rsp+50h] [rbp-61h] BYREF
</span><span class="c1"></span>  <span class="kt">int</span> <span class="n">v21</span><span class="p">;</span> <span class="c1">// [rsp+54h] [rbp-5Dh]
</span><span class="c1"></span>  <span class="kt">int</span> <span class="n">v22</span><span class="p">;</span> <span class="c1">// [rsp+58h] [rbp-59h]
</span><span class="c1"></span>  <span class="kt">int</span> <span class="n">v23</span><span class="p">;</span> <span class="c1">// [rsp+5Ch] [rbp-55h]
</span><span class="c1"></span>  <span class="kt">int</span> <span class="n">v24</span><span class="p">;</span> <span class="c1">// [rsp+60h] [rbp-51h]
</span><span class="c1"></span>  <span class="kt">int</span> <span class="n">v25</span><span class="p">;</span> <span class="c1">// [rsp+64h] [rbp-4Dh]
</span><span class="c1"></span>  <span class="kt">int</span> <span class="n">v26</span><span class="p">;</span> <span class="c1">// [rsp+68h] [rbp-49h]
</span><span class="c1"></span>  <span class="n">WCHAR</span> <span class="n">pszAlgId</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span> <span class="c1">// [rsp+70h] [rbp-41h] BYREF
</span><span class="c1"></span>  <span class="kt">int</span> <span class="n">v28</span><span class="p">;</span> <span class="c1">// [rsp+74h] [rbp-3Dh]
</span><span class="c1"></span>  <span class="kr">__int16</span> <span class="n">v29</span><span class="p">;</span> <span class="c1">// [rsp+78h] [rbp-39h]
</span><span class="c1"></span>  <span class="kt">char</span> <span class="n">v30</span><span class="p">;</span> <span class="c1">// [rsp+80h] [rbp-31h]
</span><span class="c1"></span>  <span class="kt">char</span> <span class="n">v31</span><span class="p">;</span> <span class="c1">// [rsp+81h] [rbp-30h]
</span><span class="c1"></span>  <span class="n">UCHAR</span> <span class="n">pbInputa</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span> <span class="c1">// [rsp+82h] [rbp-2Fh] BYREF
</span><span class="c1"></span>  <span class="kt">int</span> <span class="n">v33</span><span class="p">;</span> <span class="c1">// [rsp+86h] [rbp-2Bh]
</span><span class="c1"></span>  <span class="kt">int</span> <span class="n">v34</span><span class="p">;</span> <span class="c1">// [rsp+8Ah] [rbp-27h]
</span><span class="c1"></span>  <span class="kt">int</span> <span class="n">v35</span><span class="p">;</span> <span class="c1">// [rsp+8Eh] [rbp-23h]
</span><span class="c1"></span>  <span class="kt">int</span> <span class="n">v36</span><span class="p">;</span> <span class="c1">// [rsp+92h] [rbp-1Fh]
</span><span class="c1"></span>  <span class="kt">int</span> <span class="n">v37</span><span class="p">;</span> <span class="c1">// [rsp+96h] [rbp-1Bh]
</span><span class="c1"></span>  <span class="kt">int</span> <span class="n">v38</span><span class="p">;</span> <span class="c1">// [rsp+9Ah] [rbp-17h]
</span><span class="c1"></span>  <span class="kt">int</span> <span class="n">v39</span><span class="p">;</span> <span class="c1">// [rsp+9Eh] [rbp-13h]
</span><span class="c1"></span>  <span class="n">BCRYPT_ALG_HANDLE</span> <span class="n">phAlgorithm</span><span class="p">;</span> <span class="c1">// [rsp+A8h] [rbp-9h] BYREF
</span><span class="c1"></span>  <span class="n">BCRYPT_KEY_HANDLE</span> <span class="n">phKey</span><span class="p">;</span> <span class="c1">// [rsp+B0h] [rbp-1h] BYREF
</span><span class="c1"></span>  <span class="n">UCHAR</span> <span class="n">pbOutput</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span> <span class="c1">// [rsp+B8h] [rbp+7h] BYREF
</span><span class="c1"></span>  <span class="n">ULONG</span> <span class="n">pcbResult</span><span class="p">;</span> <span class="c1">// [rsp+BCh] [rbp+Bh] BYREF
</span><span class="c1"></span>  <span class="n">ULONG</span> <span class="n">v44</span><span class="p">;</span> <span class="c1">// [rsp+C0h] [rbp+Fh] BYREF
</span><span class="c1"></span>
  <span class="n">phAlgorithm</span> <span class="o">=</span> <span class="mi">0</span><span class="n">i64</span><span class="p">;</span>
  <span class="n">phKey</span> <span class="o">=</span> <span class="mi">0</span><span class="n">i64</span><span class="p">;</span>
  <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">pbOutput</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">v7</span> <span class="o">=</span> <span class="mi">98</span><span class="p">;</span>
  <span class="n">pcbResult</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">pszAlgId</span> <span class="o">=</span> <span class="err">&#39;#\</span><span class="mi">0</span><span class="n">b</span><span class="err">&#39;</span><span class="p">;</span>                 <span class="c1">// AES
</span><span class="c1"></span>  <span class="n">v8</span> <span class="o">=</span> <span class="mi">0</span><span class="n">i64</span><span class="p">;</span>
  <span class="n">v28</span> <span class="o">=</span> <span class="mi">3211303</span><span class="p">;</span>
  <span class="n">v29</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">(</span> <span class="mi">1</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">pszAlgId</span><span class="p">[</span><span class="o">++</span><span class="n">v8</span><span class="p">]</span> <span class="o">^=</span> <span class="n">v7</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">v8</span> <span class="o">&gt;=</span> <span class="mi">3</span> <span class="p">)</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="n">v7</span> <span class="o">=</span> <span class="n">pszAlgId</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
  <span class="p">}</span>
  <span class="n">v29</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">BCryptOpenAlgorithmProvider</span><span class="p">(</span><span class="o">&amp;</span><span class="n">phAlgorithm</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pszAlgId</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="n">i64</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span>
    <span class="k">return</span> <span class="mi">0</span><span class="n">i64</span><span class="p">;</span>
  <span class="n">v9</span> <span class="o">=</span> <span class="mi">0</span><span class="n">i64</span><span class="p">;</span>
  <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">pbInputa</span> <span class="o">=</span> <span class="mi">6881346</span><span class="p">;</span>                <span class="c1">// ChangingModeCBC
</span><span class="c1"></span>  <span class="n">v10</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="n">v31</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">v30</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="n">v33</span> <span class="o">=</span> <span class="mi">6815840</span><span class="p">;</span>
  <span class="n">v11</span> <span class="o">=</span> <span class="mi">111</span><span class="p">;</span>
  <span class="n">v34</span> <span class="o">=</span> <span class="mi">6815855</span><span class="p">;</span>
  <span class="n">v35</span> <span class="o">=</span> <span class="mi">6684783</span><span class="p">;</span>
  <span class="n">v36</span> <span class="o">=</span> <span class="mi">7209036</span><span class="p">;</span>
  <span class="n">v37</span> <span class="o">=</span> <span class="mi">6553701</span><span class="p">;</span>
  <span class="n">v38</span> <span class="o">=</span> <span class="mi">4390978</span><span class="p">;</span>
  <span class="n">v39</span> <span class="o">=</span> <span class="mi">66</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">(</span> <span class="mi">1</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="o">*</span><span class="p">(</span><span class="n">_WORD</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">pbInputa</span><span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">v9</span><span class="o">++</span><span class="p">]</span> <span class="o">^=</span> <span class="n">v10</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">v9</span> <span class="o">&gt;=</span> <span class="mh">0xF</span> <span class="p">)</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="n">v10</span> <span class="o">=</span> <span class="n">v30</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">HIWORD</span><span class="p">(</span><span class="n">v39</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">v12</span> <span class="o">=</span> <span class="mi">41</span><span class="p">;</span>
  <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">pszProperty</span> <span class="o">=</span> <span class="mi">6946857</span><span class="p">;</span>
  <span class="n">v13</span> <span class="o">=</span> <span class="mi">0</span><span class="n">i64</span><span class="p">;</span>
  <span class="n">v21</span> <span class="o">=</span> <span class="mi">4718657</span><span class="p">;</span>
  <span class="n">v22</span> <span class="o">=</span> <span class="mi">4653120</span><span class="p">;</span>
  <span class="n">v23</span> <span class="o">=</span> <span class="mi">4653120</span><span class="p">;</span>
  <span class="n">v24</span> <span class="o">=</span> <span class="mi">6553678</span><span class="p">;</span>
  <span class="n">v25</span> <span class="o">=</span> <span class="mi">5046342</span><span class="p">;</span>
  <span class="n">v26</span> <span class="o">=</span> <span class="mi">76</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">(</span> <span class="mi">1</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">pszProperty</span><span class="p">[</span><span class="o">++</span><span class="n">v13</span><span class="p">]</span> <span class="o">^=</span> <span class="n">v12</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">v13</span> <span class="o">&gt;=</span> <span class="mh">0xC</span> <span class="p">)</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="n">v12</span> <span class="o">=</span> <span class="n">pszProperty</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
  <span class="p">}</span>
  <span class="n">HIWORD</span><span class="p">(</span><span class="n">v26</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">BCryptSetProperty</span><span class="p">(</span><span class="n">phAlgorithm</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pszProperty</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pbInputa</span><span class="p">,</span> <span class="mh">0x20u</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span>
    <span class="k">return</span> <span class="mi">0</span><span class="n">i64</span><span class="p">;</span>
  <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">pszProperty</span> <span class="o">=</span> <span class="mi">2097263</span><span class="p">;</span>             <span class="c1">// objectLength
</span><span class="c1"></span>  <span class="n">v21</span> <span class="o">=</span> <span class="mi">327693</span><span class="p">;</span>
  <span class="n">v14</span> <span class="o">=</span> <span class="mi">0</span><span class="n">i64</span><span class="p">;</span>
  <span class="n">v22</span> <span class="o">=</span> <span class="mi">786442</span><span class="p">;</span>
  <span class="n">v23</span> <span class="o">=</span> <span class="mi">2293787</span><span class="p">;</span>
  <span class="n">v24</span> <span class="o">=</span> <span class="mi">65546</span><span class="p">;</span>
  <span class="n">v25</span> <span class="o">=</span> <span class="mi">1769480</span><span class="p">;</span>
  <span class="n">v26</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">(</span> <span class="mi">1</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">pszProperty</span><span class="p">[</span><span class="o">++</span><span class="n">v14</span><span class="p">]</span> <span class="o">^=</span> <span class="n">v11</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">v14</span> <span class="o">&gt;=</span> <span class="mh">0xC</span> <span class="p">)</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="n">v11</span> <span class="o">=</span> <span class="n">pszProperty</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
  <span class="p">}</span>
  <span class="n">HIWORD</span><span class="p">(</span><span class="n">v26</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">BCryptGetProperty</span><span class="p">(</span><span class="n">phAlgorithm</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pszProperty</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pbOutput</span><span class="p">,</span> <span class="mi">4u</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pcbResult</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span>
    <span class="k">return</span> <span class="mi">0</span><span class="n">i64</span><span class="p">;</span>
  <span class="n">v15</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">pbOutput</span><span class="p">;</span>
  <span class="n">ProcessHeap</span> <span class="o">=</span> <span class="n">GetProcessHeap</span><span class="p">();</span>
  <span class="n">v17</span> <span class="o">=</span> <span class="p">(</span><span class="n">UCHAR</span> <span class="o">*</span><span class="p">)</span><span class="n">HeapAlloc</span><span class="p">(</span><span class="n">ProcessHeap</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">v15</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">v17</span> <span class="p">)</span>
    <span class="k">return</span> <span class="mi">0</span><span class="n">i64</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">BCryptGenerateSymmetricKey</span><span class="p">(</span><span class="n">phAlgorithm</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">phKey</span><span class="p">,</span> <span class="n">v17</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="n">ULONG</span> <span class="o">*</span><span class="p">)</span><span class="n">pbOutput</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pbSecret</span><span class="p">,</span> <span class="mh">0x20u</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span>
    <span class="k">return</span> <span class="mi">0</span><span class="n">i64</span><span class="p">;</span>
  <span class="n">v44</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">BCryptDecrypt</span><span class="p">(</span><span class="n">phKey</span><span class="p">,</span> <span class="n">pbInput</span><span class="p">,</span> <span class="mh">0x10u</span><span class="p">,</span> <span class="mi">0</span><span class="n">i64</span><span class="p">,</span> <span class="n">a4</span><span class="p">,</span> <span class="mh">0x10u</span><span class="p">,</span> <span class="n">a5</span><span class="p">,</span> <span class="mh">0x10u</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v44</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span>
    <span class="k">return</span> <span class="mi">0</span><span class="n">i64</span><span class="p">;</span>
  <span class="n">BCryptDestroyKey</span><span class="p">(</span><span class="n">phKey</span><span class="p">);</span>
  <span class="n">BCryptCloseAlgorithmProvider</span><span class="p">(</span><span class="n">phAlgorithm</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
  <span class="n">v18</span> <span class="o">=</span> <span class="n">GetProcessHeap</span><span class="p">();</span>
  <span class="n">HeapFree</span><span class="p">(</span><span class="n">v18</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">v17</span><span class="p">);</span>
  <span class="k">return</span> <span class="mi">1</span><span class="n">i64</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Nhưng khi chạy đến cuối hàm thì gặp lỗi này.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://hackmd.io/_uploads/BJ-PR-f-yx.png"
        data-srcset="https://hackmd.io/_uploads/BJ-PR-f-yx.png, https://hackmd.io/_uploads/BJ-PR-f-yx.png 1.5x, https://hackmd.io/_uploads/BJ-PR-f-yx.png 2x"
        data-sizes="auto"
        alt="https://hackmd.io/_uploads/BJ-PR-f-yx.png"
        title="https://hackmd.io/_uploads/BJ-PR-f-yx.png" /></p>
<p>Lỗi này gây ra do <strong><code>rcx</code></strong> chưa trỏ đúng vào vị trí bộ nhớ.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://hackmd.io/_uploads/B1Gv0-fZ1x.png"
        data-srcset="https://hackmd.io/_uploads/B1Gv0-fZ1x.png, https://hackmd.io/_uploads/B1Gv0-fZ1x.png 1.5x, https://hackmd.io/_uploads/B1Gv0-fZ1x.png 2x"
        data-sizes="auto"
        alt="https://hackmd.io/_uploads/B1Gv0-fZ1x.png"
        title="https://hackmd.io/_uploads/B1Gv0-fZ1x.png" /></p>
<p>Lúc này, mình tìm xung quanh các thanh ghi <strong><code>rcx</code></strong> để xem nó bị ảnh hưởng bởi thanh ghi nào. Ta thấy có <strong><code>rax</code></strong> và <strong><code>rbx</code></strong> tác động tới nó</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://hackmd.io/_uploads/rJbDC-f-1e.png"
        data-srcset="https://hackmd.io/_uploads/rJbDC-f-1e.png, https://hackmd.io/_uploads/rJbDC-f-1e.png 1.5x, https://hackmd.io/_uploads/rJbDC-f-1e.png 2x"
        data-sizes="auto"
        alt="https://hackmd.io/_uploads/rJbDC-f-1e.png"
        title="https://hackmd.io/_uploads/rJbDC-f-1e.png" /></p>
<p>Do <code>rax</code> trên stack nên mình bỏ qua, tìm xung quanh giá trị của <code>rbx</code>, ta thấy có đống dữ liệu rất khả nghi.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://hackmd.io/_uploads/SkxMP0ZGWkx.png"
        data-srcset="https://hackmd.io/_uploads/SkxMP0ZGWkx.png, https://hackmd.io/_uploads/SkxMP0ZGWkx.png 1.5x, https://hackmd.io/_uploads/SkxMP0ZGWkx.png 2x"
        data-sizes="auto"
        alt="https://hackmd.io/_uploads/SkxMP0ZGWkx.png"
        title="https://hackmd.io/_uploads/SkxMP0ZGWkx.png" /></p>
<p>Đưa <code>rcx</code> trỏ về đây, chạy nốt chương trình và thu được flag <code>ISITDTU{STATIC_STRUCt_INITIALIZATION_FAiLED}</code></p>
<h2 id="pwnshellcode-2">pwn/shellcode 2</h2>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ul>
<li>61 solves / 100 pts / by code016hiro</li>
<li><strong>Given files:</strong> <a href="https://drive.google.com/file/d/1_w9se3I6o9esnnMt1OyISZEqid5HGvUO/view" target="_blank" rel="noopener noreffer ">https://drive.google.com/file/d/1_w9se3I6o9esnnMt1OyISZEqid5HGvUO/view</a></li>
<li><strong>Description:</strong> <code>nc 152.69.210.130 3002</code></li>
</ul>
</div>
        </div>
    </div>
<hr>
<h1 id="-list-challenges">🔥 List challenges</h1>
<p>rev/2much</p>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ul>
<li>9 solves / 463 pts / by kinjazz</li>
<li><strong>Given files:</strong> 2much</li>
</ul>
</div>
        </div>
    </div>
<p>rev/FlagCpp</p>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ul>
<li>6 solves / 486 pts / by ks75vl</li>
<li><strong>Given files:</strong> <a href="https://ctf.isitdtu.com/files/05153c62f8deaf01bbbf0e0cf1cf1ff8/FlagCpp_5C9F861EFCC1AFF273C435E3CC988438.zip?token=eyJ1c2VyX2lkIjoyMzUwLCJ0ZWFtX2lkIjoxNDAyLCJmaWxlX2lkIjo2M30.Zx57eg.J9fLcNCPDtdvOzQzBeZt29tsZqs" target="_blank" rel="noopener noreffer ">FlagCpp_5C9F861EFCC1AFF273C435E3CC988438.zip</a></li>
<li><strong>Description:</strong> Trust me, this program was written in <code>C++</code>.</li>
</ul>
</div>
        </div>
    </div>
<p>pwn/shellcode 1</p>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ul>
<li>68 solves / 100 pts / by code016hiro</li>
<li><strong>Given files:</strong> <a href="https://drive.google.com/file/d/1VYDG9AFhaSddgn9qr8cWCaN5qVb-fQCE/view" target="_blank" rel="noopener noreffer ">https://drive.google.com/file/d/1VYDG9AFhaSddgn9qr8cWCaN5qVb-fQCE/view</a></li>
<li><strong>Description:</strong> <code>nc 152.69.210.130 3001</code></li>
</ul>
</div>
        </div>
    </div>
<p>pwn/Game of Luck</p>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ul>
<li>43 solves / 100 pts</li>
<li><strong>Given files:</strong> chall</li>
<li><strong>Description:</strong> <code>nc 152.69.210.130 2004</code></li>
</ul>
</div>
        </div>
    </div>
<p>pwn/no_name</p>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ul>
<li>29 solves / 100 pts</li>
<li><strong>Given files:</strong> no_name.zip</li>
<li><strong>Description:</strong> <code>nc 152.69.210.130 1337</code></li>
</ul>
</div>
        </div>
    </div>
<p>forensics/CPUsage</p>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ul>
<li>37 solves / 100 pts / by M4shl3</li>
<li><strong>Given files:</strong> <a href="https://drive.proton.me/urls/5MM9NY7SZW#O3lmkiJIBJzr" target="_blank" rel="noopener noreffer ">https://drive.proton.me/urls/5MM9NY7SZW#O3lmkiJIBJzr</a></li>
<li><strong>Description:</strong> My friend noticed a high usage of CPU after he opened his laptop, I just take a memory dump of his laptop, and needs you to investigate it. Q1- What is the name of the malicious process, full path of the process, parent process id? Q2- what is the ip that process communicate with, family name of the malware<br>
Format flag: <code>ISITDTU{processName-FullPath-ID_ip-FamilyName}</code> <br>
Eg: <code>ISITDTU{Spotify.exe-Path-141_192.168.1.1-isitdtu}</code></li>
</ul>
</div>
        </div>
    </div>
<p>forensics/Corrupted Hard Drive</p>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ul>
<li>46 solves / 100 pts / by M4shl3 x vizer</li>
<li><strong>Given files:</strong> <a href="https://drive.proton.me/urls/15NQK5V8B0#VAesxikOWzxP" target="_blank" rel="noopener noreffer ">https://drive.proton.me/urls/15NQK5V8B0#VAesxikOWzxP</a></li>
<li><strong>Description:</strong> You’ve come across a damaged disk image retrieved from my friend&rsquo;s laptop, he downloaded some good stuff then went to bathroom, but when came, he found that he can&rsquo;t access the disk. The file system appears to be corrupted, but hidden deep inside the broken structure lies critical information that could unlock the next step in your investigation.
<code>nc 152.69.210.130 1411</code></li>
</ul>
</div>
        </div>
    </div>
<p>forensics/unexpected</p>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ul>
<li>17 solves / 349 pts / by 3r3m1t1c</li>
<li><strong>Given files:</strong> <a href="https://drive.google.com/file/d/1_pfVtaS1oMeiWd9dgqLP97yiLfD60Sih/view" target="_blank" rel="noopener noreffer ">https://drive.google.com/file/d/1_pfVtaS1oMeiWd9dgqLP97yiLfD60Sih/view</a></li>
<li><strong>Description:</strong> Aquanman Investigation Company is currently recruiting for the role of Digital Forensics Investigator. As part of the application process, candidates are required to complete a challenge designed to assess their skills in digital forensics. Applicants will need to investigate a simulated attack, analyze the provided evidence, and submit the flag.</li>
</ul>
<p>The flag is divided into three different parts!</div>
        </div>
    </div>
<p>forensics/swatted</p>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ul>
<li>15 solves / 385 pts / by 3r3m1t1c</li>
<li><strong>Given files:</strong> <a href="https://drive.google.com/file/d/15fdpvHGRI94QGzUZ61CYX2rVbKGAYDVU/view" target="_blank" rel="noopener noreffer ">https://drive.google.com/file/d/15fdpvHGRI94QGzUZ61CYX2rVbKGAYDVU/view</a></li>
<li><strong>Description:</strong> San Andreas PD recently conducted a raid on a suspect&rsquo;s residence, discovering that their laptop contains crucial evidence. As a Digital Forensics Investigator, it is now your responsibility to analyze the evidence and answer the related questions.
<code>nc 152.69.210.130 1259</code></li>
</ul>
</div>
        </div>
    </div>
<p>forensics/Initial</p>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ul>
<li>10 solves / 453 pts / by M4shl3</li>
<li><strong>Given files:</strong> <a href="https://drive.proton.me/urls/ZYS0NTACTC#2E4aPfRdGZum" target="_blank" rel="noopener noreffer ">https://drive.proton.me/urls/ZYS0NTACTC#2E4aPfRdGZum</a></li>
<li><strong>Description:</strong> A Windows environment has been compromised .The attacker used a known feature in windows which served as the initial vector of the attack. Your task is to investigate &amp; SEARCH how the attacker get the initial access.</li>
</ul>
</div>
        </div>
    </div>
<p>web/Another one</p>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ul>
<li>103 solves / 100 pts / by khanhhnahk1</li>
<li><strong>Given files:</strong> <a href="https://ctf.isitdtu.com/files/4e936e9c5732e01b42eea36e1dc838f5/Another_one_dist.zip?token=eyJ1c2VyX2lkIjoyMzUwLCJ0ZWFtX2lkIjoxNDAyLCJmaWxlX2lkIjo2MH0.Zx6EFA.FTrsquEeeKuzC1Co3hVQxJga6tQ" target="_blank" rel="noopener noreffer ">Another_one_dist.zip</a></li>
<li><strong>Description:</strong> Tell them bring out the lobster ☝️</li>
</ul>
<p>Please test locally before testing on remote.</p>
<p><a href="http://152.69.210.130:5000/" target="_blank" rel="noopener noreffer ">http://152.69.210.130:5000</a>
<a href="http://20.198.254.169:5000/" target="_blank" rel="noopener noreffer ">http://20.198.254.169:5000</a></p>
</div>
        </div>
    </div>
<p>web/X Éc Éc</p>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ul>
<li>63 solves / 100 pts / by onrsa</li>
<li><strong>Given files:</strong> <a href="https://drive.proton.me/urls/ZYS0NTACTC#2E4aPfRdGZum" target="_blank" rel="noopener noreffer ">https://drive.proton.me/urls/ZYS0NTACTC#2E4aPfRdGZum</a></li>
<li><strong>Description:</strong> <strong><code>&quot;dependencies&quot;:  {&quot;dompurify&quot;: &quot;^3.1.6&quot;}</code></strong>
Warm up liu tiu riu :v
Chall: <a href="http://152.69.210.130/" target="_blank" rel="noopener noreffer ">http://152.69.210.130</a></li>
</ul>
<p>Bot: <a href="http://152.69.210.130:81/report/" target="_blank" rel="noopener noreffer ">http://152.69.210.130:81/report</a></div>
        </div>
    </div>
<p>web/S1mple</p>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ul>
<li>35 solves / 100 pts / by 0x90</li>
<li><strong>Given files:</strong> Dockerfile</li>
<li><strong>Description:</strong> Just a simple HTTP Server <a href="http://35.240.202.218:8000/" target="_blank" rel="noopener noreffer ">http://35.240.202.218:8000</a></li>
</ul>
</div>
        </div>
    </div>
</aside>
<h1 id="webhihi">web/<strong>hihi</strong></h1>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ul>
<li>20 solves / 287 pts / by khanhhnahk1</li>
<li><strong>Given files:</strong> <a href="https://drive.google.com/file/d/13p2eQemGAHZm35g1040T8Yo_rp26x8Sq/view" target="_blank" rel="noopener noreffer ">https://drive.google.com/file/d/13p2eQemGAHZm35g1040T8Yo_rp26x8Sq/view</a></li>
<li><strong>Description:</strong> 🤭🤭 Chall: <a href="http://213.35.127.196:8083/" target="_blank" rel="noopener noreffer ">http://213.35.127.196:8083</a></li>
</ul>
</div>
        </div>
    </div>
<h1 id="webniceray">web/<strong>niceray</strong></h1>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ul>
<li>17 solves / 349 pts / by Onsra x Deku</li>
<li><strong>Given files:</strong> <a href="https://drive.google.com/file/d/1mTkXeAxAPmEGcwwjylxlZ7Xlni9Hw99o/view" target="_blank" rel="noopener noreffer ">https://drive.google.com/file/d/1mTkXeAxAPmEGcwwjylxlZ7Xlni9Hw99o/view</a></li>
<li><strong>Description:</strong> Niceray or Nineray or Liferay :)))</li>
</ul>
<p>Please test locally before testing on remote. Any team that has captured the flag on the local instance, please DM the two authors below or create a ticket, and we will open an instance for you to capture the flag remotely. The instance creation link will be updated soon (since we&rsquo;re getting a high-RAM VPS to support this challenge :v )</p>
<p><strong>Hint</strong>: Due to a configuration, teams can still exploit the
endpoint <strong><code>/api/jsonws/invoke</code></strong> locally, but it won’t be exploitable remotely.</p>
</div>
        </div>
    </div>
<p>web/Hero</p>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ul>
<li>5 solves / 491 pts / by taidh</li>
<li><strong>Description:</strong> I&rsquo;m too busy with work to create a hard challenge, so here is an easy one. Enjoy and get free points from it!
Link challenge: <a href="http://213.35.127.196:63432/" target="_blank" rel="noopener noreffer ">http://213.35.127.196:63432</a></li>
</ul>
</div>
        </div>
    </div>
<p>web/Geo Weapon</p>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ul>
<li>0 solve / 1000 pts / by pew</li>
<li><strong>Given files:</strong> dist.zip</li>
<li><strong>Description:</strong> Little weapon, little weapon, little weapon We&rsquo;re calling you There&rsquo;s a war, if the guns are just to tall for you. We&rsquo;ll find you something small to use Little weapon, little weapon, little weapon. We need you now, blaow!
By: Pew (This challenge expects you to find a 0day. If one is found pls report it yourself to the respected party.) Please test locally before testing on remote, ips that abuse instance will be blocked !!!
<code>nc 213.35.127.196 4444</code></li>
</ul>
</div>
        </div>
    </div>
<p>crypto/ShareMixer1</p>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ul>
<li>42 solves / 100 pts / by catto</li>
<li><strong>Given files:</strong> chall.py</li>
<li><strong>Description:</strong> Let&rsquo;s mix some shares!!!!!!!!!!!!!!!!!!!!!!!!! <code>nc 35.187.238.100 5001</code></li>
</ul>
</div>
        </div>
    </div>
<p>crypto/ShareMixer2</p>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ul>
<li>32 solves / 100 pts / by catto</li>
<li><strong>Given files:</strong> chall.py</li>
<li><strong>Description:</strong> Let&rsquo;s mix some shares!!!!!!!!!!!!!!!!!!!!!!!!! Again :&gt; <code>nc 35.187.238.100 5002</code></li>
</ul>
</div>
        </div>
    </div>
<p>crypto/Sign</p>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ul>
<li>23 solves / 214 pts / by m1dm4n</li>
<li><strong>Given files:</strong> chall.py</li>
<li><strong>Description:</strong> I love giving out signatures :&quot;&gt; As long as my modulus are hidden, you can&rsquo;t know what I&rsquo;m signing!
<code>nc 35.187.238.100 5003</code></li>
</ul>
</div>
        </div>
    </div>
<p>crypto/thats so random</p>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ul>
<li>9 solves / 463 pts</li>
<li><strong>Given files:</strong>
<ul>
<li>chall.py</li>
<li>output.txt</li>
</ul>
</li>
</ul>
</div>
        </div>
    </div>
<p>crypto/somesomesome</p>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ul>
<li>6 solves / 486 pts</li>
<li><strong>Given files:</strong> <a href="https://ctf.isitdtu.com/files/3ed230ade12b92c7df7a99384f28008f/somesomesome.py?token=eyJ1c2VyX2lkIjoyMzUwLCJ0ZWFtX2lkIjoxNDAyLCJmaWxlX2lkIjo1Nn0.Zx6KVA.hpFJRHyfE-msiHu6eIHVEOFrQ-Q" target="_blank" rel="noopener noreffer ">somesomesome.py</a></li>
</ul>
</div>
        </div>
    </div></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2024-11-01</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/2024_isitdtu_quals/index.md" target="_blank">Read Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://ducdatdau.github.io/2024_isitdtu_quals/" data-title="ISITDTU Quals 2024" data-hashtags="RE,ISITDTU,vietnamese"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://ducdatdau.github.io/2024_isitdtu_quals/" data-hashtag="RE"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Reddit" data-sharer="reddit" data-url="https://ducdatdau.github.io/2024_isitdtu_quals/"><i class="fab fa-reddit fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/re/">RE</a>,&nbsp;<a href="/tags/isitdtu/">ISITDTU</a>,&nbsp;<a href="/tags/vietnamese/">vietnamese</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.92.2">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2024</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://ducdatdau.github.io/" target="_blank">ducdatdau</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/lightgallery/css/lightgallery-bundle.min.css"><link rel="stylesheet" href="/lib/katex/katex.min.css"><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lightgallery.min.js"></script><script type="text/javascript" src="/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js"></script><script type="text/javascript" src="/lib/lightgallery/plugins/zoom/lg-zoom.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/auto-render.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/copy-tex.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/mhchem.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{},"lightgallery":true,"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
